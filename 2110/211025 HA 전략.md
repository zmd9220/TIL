# 211025 HA 전략



### 컨설턴트님에게 배운 HA에 대해

- HA? - HA(High Availability) 고가용성 - 현업에서 많이 사용되는 용어

#### 

#### Active, Stand By

- active - 사용
- standby - 예외 처리를 위해 대기
- single point off 



#### Scale up, Scale out

- 스케일업? 스케일 아웃?
  - 80개를 처리하는 pc 3대보다 100개 처리하는 1대가 더비쌈
  - 스케일 업과 아웃이 다른 의미네요 감사합니다
  - scale up - ram을 8gb -> 16gb로 업글
  - scale out - 클러스터 pc를 1대에서 2대로 늘린다.



#### Master, Slave

- master - 주요 기능(동작의 주체) - READ 제외한 모든것 D는 DBA만 보통 가능하도록 되어있음(현업)
- slave - 마스터의 지시 or 본인 스스로 판단해서 마스터가 하는 기능 외에 기능을 도와주는 종속적인 역할 - READ
  - slave는 확장이 가능 (master 1개에 slave를 늘릴 수 있음) - 분산처리가 가능 -> CRUD중 가장 많은 트래픽을 사용하는 R 담당(약 95%의 리소스를 차지함)
- backup - 특정 서버의 역할을 대체하기 위해, 준비된 서버 - standby와 유사?



#### Active, Stand By의 예시

##### 캐시서버의 이중화 구성(예시) - redis(안전성 문제가 조금 있음), 휘발성 그래서 이중화를 진행함

- ex) 게임서버 캐시
- active - 사용자에 요청에 대답(일반적인 경우) -> 비정상적인 요청에 서버가 죽음 -> 죽은걸 감지하고 standby가 등장(하트비트) - 데이터의 중요도, 기업마다 다르지만 보통 5~8초 -> standby가 active를 대체하여 진행됨(failover) -> 그리고 active를 다시 고쳐서 올림 -> 개발자에게 active가 다운됐음을 알림 + autofailover(자동 대체) radis 기준(센티널) -> 미러링(active가 변경되면 standby 도 변경), AP단에서 변경시키거나 active가 변경되면 standby에 바뀌었음을 보내주던가 개발 방법은 개발자의 자유

- 캐시서버의 마스터 슬레이브 구조는 본 적 없다.



#### Master, Slave 구조의 대표적 예시

##### mysql에서 replication 구성



##### 로드밸런싱 구조

- 로드밸런서란? (software, hardware든) - 로드밸런싱을 위한 장치
- 로드밸런싱, 미러링, 스케일아웃 - 로드밸런서를 통해 클러스터링 구조 구축한 형태
- 로드밸런싱의 좋은점
  - 공인망 (대표적인 입구)만 외부에서 접근함으로서 사설망의 접근을 막을 수 있음(보안)
  - 망으로 구분? 사설망?acl
  - 데이터 분산겸 보안으로도 좋아서 로드밸런싱을 사용함

#### 위의 이야기에서 추가되는 DevOps 인프라 상식

- VRRP (Virtual Router Redundancy Protocol)
- ipv4는 현재 공인 ip가 거의 다 사용됨 -> 기업에 보통 공인 ip 한개 할당 -> ip밑에 사설 ip를 할당해서 나눠서씀
- 특정 사설 ip가 요청한 외부 데이터(요청 받은 데이터 응답) -> 공인 ip -> 특정 사설 ip
- 사설 ip -> 공인 ip -> 외부
- 사설 ip끼리는 네트워크가 되어있어서 바로바로 연결 가능

- 1~1000 router A 1001~2000 router B 와 같이 라우터 별로 영역 관리
- 라우터 장비도 싸진않아서.. 많이 배치하진 않는다.



#### 질문 내역

- 예전에 RAID를 배운적있는데 요즘은 잘 안쓰나요? RAID도 쓴다. 개념은 같은데 적용하는 대상, 방법이 다르다. 
- DB에서는 RAID 0, RAID 1이 아까 보여줬던 예시가 서버에서는 클러스터링(분산저장) , 미러링으로 말할 뿐 기본적인 개념은 유사하다.(미러링)
- 아까 보여줬던 캐시 서버 예시에서 redis가 취하는 미러링 전략이 RAID 1과 같다고 생각하심 된다.
  
  