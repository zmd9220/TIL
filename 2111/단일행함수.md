| 단일행 함수 : 한 건의 행이 입력되어, 한 건을 리턴            |                               |                                           |                                                              |                          |        |                             |
| ------------------------------------------------------------ | ----------------------------- | ----------------------------------------- | ------------------------------------------------------------ | ------------------------ | ------ | --------------------------- |
| 복수행 함수 : 두 건  이상의 행이 입력되어, 한 건을 리턴      |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 단일행 함수                                                  |                               |                                           |                                                              |                          |        |                             |
| 1. 문자형 함수                                               |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 사용방법                                                     |                               |                                           |                                                              |                          |        | 결과                        |
| SELECT  UPPER('oracle') FROM dual;                           |                               |                                           |                                                              | ORACLE                   |        |                             |
| SELECT  LOWER('ORACLE') FROM dual;                           |                               |                                           | oracle                                                       |                          |        |                             |
| SELECT  INITCAP('oracle') FROM dual;                         |                               |                                           | Oracle                                                       |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  CONCAT('oracle', 'database') FROM dual;              |                               |                                           | oracle database                                              |                          |        |                             |
| SELECT  SUBSTR('oracle database 10g release 2', 8, 8) FROM dual; | database                      |                                           |                                                              |                          |        |                             |
| SELECT  SUBSTR('oracle database 10g release 2', -9, 7) FROM dual; | release                       |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  LENGTH('oracle') FROM dual;                          |                               |                                           | 6                                                            |                          |        |                             |
| SELECT  INSTR('oracle database 10g release 2', 'a', 4, 2) FROM dual; | 11                            |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  LPAD('oracle', 10, '*') FROM dual;                   |                               |                                           | ****oracle                                                   |                          |        |                             |
| SELECT  RPAD('oracle', 10, '*') FROM dual;                   |                               |                                           | oracle****                                                   |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  LTRIM('oooracle', 'o') FROM dual;                    |                               |                                           | racle                                                        |                          |        |                             |
| SELECT  RTRIM('oracleee', 'e') FROM dual;                    |                               |                                           | oracl                                                        |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  TRIM(BOTH 'o' FROM 'oooracleoo') FROM dual;          |                               | racle                                     |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  REPLACE('oracle database 10g release 2', '10g', '11g') FROM dual; | oracle database 11g release 2 |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 팁                                                           |                               |                                           |                                                              |                          |        |                             |
| : LPAD,  RPAD를 사용하여 간단한 그래프 출력                  |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| : 예) *를 10개  출력하고 싶은 경우                           |                               |                                           |                                                              |                          |        |                             |
| SELECT  LPAD('*', 10, '*') FROM dual;                        |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 2. 숫자함수                                                  |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 사용방법                                                     |                               |                                           |                                                              |                          |        | 결과                        |
| SELECT  ROUND(1234.5678) FROM dual;                          |                               |                                           | 1235                                                         |                          |        |                             |
| SELECT  ROUND(1234.5678, 1) FROM dual;                       |                               |                                           | 1234.6                                                       |                          |        |                             |
| SELECT  ROUND(1234.5678, 2) FROM dual;                       |                               |                                           | 1234.57                                                      |                          |        |                             |
| SELECT  ROUND(1234.5678, -1) FROM dual;                      |                               |                                           | 1230                                                         |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  TRUNC(1234.5678) FROM dual;                          |                               |                                           | 1234                                                         |                          |        |                             |
| SELECT  TRUNC(1234.5678, 1) FROM dual;                       |                               |                                           | 1234.5                                                       |                          |        |                             |
| SELECT  TRUNC(1234.5678, 2) FROM dual;                       |                               |                                           | 1234.56                                                      |                          |        |                             |
| SELECT  TRUNC(1234.5678, -1) FROM dual;                      |                               |                                           | 1230                                                         |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  MOD(3, 2) FROM dual;                                 |                               |                                           |                                                              | 1                        |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  CEIL(1234.1234) FROM dual;                           |                               |                                           |                                                              | 1235                     |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 3. 날짜함수                                                  |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 날짜연산                                                     |                               |                                           |                                                              |                          |        |                             |
| * 날짜 + 숫자 =  날짜 (예: 오늘 날짜 + 1 = 내일 날짜)        |                               |                                           |                                                              |                          |        |                             |
| * 날짜 - 숫자 =  날짜 (예: 오늘 날짜 - 1 = 어제 날짜)        |                               |                                           |                                                              |                          |        |                             |
| * 날짜 - 날짜 =  숫자 (예: 오늘 날짜 - 어제 날짜 = 1)        |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 날짜 표시 방법 변경                                          |                               |                                           |                                                              |                          |        |                             |
| ALTER  SESSION SET nls_date_format = 'yyyy/mm/dd hh24:mi:ss'; |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 디폴트                                                       |                               |                                           |                                                              |                          |        |                             |
| ALTER  SESSION SET nls_date_format = 'rr/mm/dd';             |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 사용방법                                                     |                               |                                           |                                                              |                          |        | 결과                        |
| SELECT  SYSDATE FROM dual;                                   |                               |                                           |                                                              | (현재 시스템 날짜)       |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  SYSDATE+1 FROM dual;                                 |                               |                                           |                                                              | (현재 시스템 날짜 + 1일) |        |                             |
| SELECT  SYSDATE-hiredate FROM emp;                           |                               |                                           | (입사 후, 며칠 지났는지)                                     |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  MONTHS_BETWEEN(SYSDATE, hiredate) FROM emp;          |                               | (입사 후, 몇 개월 지났는지)               |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  ADD_MONTHS(hiredate, 6) FROM emp;                    |                               |                                           | (입사 후, 6개월이 지난 날짜)                                 |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  NEXT_DAY(hiredate, '일') FROM emp;                   |                               |                                           | (입사 후, 첫번째 일요일의 날짜)                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  LAST_DAY(hiredate) FROM emp;                         |                               |                                           | (입사한 달의 마지막 날짜)                                    |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  ROUND(hiredate, 'YEAR') FROM emp;                    |                               |                                           | (입사한 달이 7월 이후면, 다음 년도로 반올림)                 |                          |        |                             |
| SELECT  ROUND(hiredate, 'MONTH') FROM emp;                   |                               |                                           | (입사한 일이 15일 이후면, 다음 달로 반올림)                  |                          |        |                             |
| SELECT  ROUND(hiredate) FROM emp;                            |                               |                                           | (입사한 시간이 정오 이후면, 다음 날짜로 반올림)              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  TRUNC(hiredate, 'YEAR') FROM emp;                    |                               |                                           | (입사일을 당해년도 1월 1일로 내림 )                          |                          |        |                             |
| SELECT  TRUNC(hiredate, 'MONTH') FROM emp;                   |                               |                                           | (입사일을 당월 1일로 내림)                                   |                          |        |                             |
| SELECT  TRUNC(hiredate) FROM emp;                            |                               |                                           | (입사일에서 시간을 자정으로 내림)                            |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 4. 형변환 함수                                               |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 암묵적 형변환                                                |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 할당 연산                                                    |                               |                                           |                                                              |                          |        |                             |
| 변환 전                                                      |                               |                                           | 변환 후                                                      |                          |        |                             |
| ![img](file:///C:\Users\korea7\AppData\Local\Temp\msohtmlclip1\01\clip_image004.png)         VARCHAR2    또는 CHAR |                               |                                           | NUMBER                                                       |                          |        |                             |
| VARCHAR3  또는 CHAR                                          |                               | DATE                                      |                                                              |                          |        |                             |
| NUMBER                                                       |                               |                                           | VARCHAR2                                                     |                          |        |                             |
| DATE                                                         |                               |                                           | VARCHAR2                                                     |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| EMP                                                          |                               |                                           |                                                              |                          |        |                             |
| empno                                                        | hiredate                      | phone                                     | birthdate                                                    |                          |        |                             |
| NUMBER                                                       | DATE                          | VARCHAR2                                  | VARCHAR2                                                     |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| '1001'                                                       | '2010/01/01'                  | 2345243                                   | SYSDATE                                                      |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 비교 연산                                                    |                               |                                           |                                                              |                          |        |                             |
| 변환 전                                                      |                               |                                           | 변환 후                                                      |                          |        |                             |
| VARCHAR2 또는 CHAR                                           |                               |                                           | NUMBER                                                       |                          |        |                             |
| VARCHAR2  또는 CHAR                                          |                               | DATE                                      |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| EMP                                                          |                               |                                           |                                                              |                          |        |                             |
| empno                                                        | hiredate                      | phone                                     | birthdate                                                    |                          |        |                             |
| NUMBER                                                       | DATE                          | VARCHAR2                                  | VARCHAR2                                                     |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 1001                                                         | 2010-01-01                    | '2345243'                                 | '2010/01/01'                                                 |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT *  FROM emp WHERE empno='1001';                       |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT *  FROM emp WHERE hiredate='2010/01/01';              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT *  FROM emp WHERE phone=2345243;                      |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        | INTERNAL SUPPRESSING의 원인 |
| SELECT *  FROM emp WHERE birthdate=SYSDATE;                  |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 명시적 형변환                                                |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               | TO_DATE                                   |                                                              | TO_CHAR                  |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              | DATE                          |                                           | CHAR                                                         |                          | NUMBER |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               | TO_CHAR                                   |                                                              | TO_NUMBER                |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 사용방법                                                     |                               |                                           |                                                              |                          |        | 결과                        |
| SELECT  TO_DATE('20100101132030', 'YYYYMMDDHH24MISS') FROM dual; | 2010-01-01 13:20              |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  TO_NUMBER('\1,234,567.89', 'L9,999,999.00') FROM dual; | 1234567.89                    |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  TO_CHAR(1234567.89, 'L9,999,999.00') FROM dual;      |                               | '\1,234,567.89'                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') FROM dual;      | '20100101132030'              |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  TO_CHAR(SYSDATE, 'DAY') FROM dual;                   |                               |                                           | 월요일                                                       |                          |        |                             |
| SELECT  TO_CHAR(SYSDATE, 'DY') FROM dual;                    |                               |                                           | 월                                                           |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 날짜 및 시간 형식  포맷 모델                                 |                               |                                           |                                                              |                          |        |                             |
| 형식                                                         |                               |                                           | 설명                                                         |                          |        |                             |
| YYYY                                                         |                               |                                           | 년도를 숫자로 표시                                           |                          |        |                             |
| YEAR                                                         |                               |                                           | 년도를 영문으로 표시                                         |                          |        |                             |
| MM                                                           |                               |                                           | 월을 숫자로 표시                                             |                          |        |                             |
| MONTH                                                        |                               |                                           | 월을 영문으로 표시(JANUARY, FEBRUARY, …)                     |                          |        |                             |
| MON                                                          |                               |                                           | 월을 영문 3자리로 축약해서 표시(JAN, FEB, …)                 |                          |        |                             |
| DY                                                           |                               |                                           | 요일을 영문 3자리로 축약해서 표시(SUN, MON, …), 한글  환경에서는 한글 1자로 표시 |                          |        |                             |
| DAY                                                          |                               |                                           | 요일을 영문으로 표시(SUNDAY, MONDAY, …), 한글  환경에서는 한글 3자로 표시 |                          |        |                             |
| DD                                                           |                               |                                           | 일을 숫자로 표시                                             |                          |        |                             |
| AM  또는 PM                                                  |                               | 오전 또는 오후를 표시                     |                                                              |                          |        |                             |
| A.M  또는 P.M                                                |                               | 오전 또는 오후를 표시                     |                                                              |                          |        |                             |
| HH 또는 HH12 또는 HH24                                       | 시간 또는 1~12시 또는 1~24시  |                                           |                                                              |                          |        |                             |
| MI                                                           |                               |                                           | 분(0~59)                                                     |                          |        |                             |
| SS                                                           |                               |                                           | 초(0~59)                                                     |                          |        |                             |
| SSSSS                                                        |                               |                                           | 자정 이후 초(0~86399)                                        |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 기타 형식 포맷 모델                                          |                               |                                           |                                                              |                          |        |                             |
| 형식                                                         |                               |                                           | 설명                                                         |                          |        |                             |
| / . ,                                                        |                               |                                           | 구분자 표시                                                  |                          |        |                             |
| "of the"                                                     |                               |                                           | 결과에 추가할 문자열                                         |                          |        |                             |
| TH                                                           |                               |                                           | 서수 표시(예, DDTH인 경우 4TH)                               |                          |        |                             |
| SP                                                           |                               |                                           | 영문 기수 표시(예, DDSP인 경우 FOUR)                         |                          |        |                             |
| SPTH  또는 THSP                                              |                               | 영문 서수 표시(예, DDSPTH인 경우  FOURTH) |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 숫자 형식 포맷 모델                                          |                               |                                           |                                                              |                          |        |                             |
| 형식                                                         |                               |                                           | 설명                                                         |                          |        |                             |
| 9                                                            |                               |                                           | 숫자로 표시                                                  |                          |        |                             |
| 0                                                            |                               |                                           | 숫자의 앞부분을 0으로 표시                                   |                          |        |                             |
| $                                                            |                               |                                           | 달러 표시                                                    |                          |        |                             |
| L                                                            |                               |                                           | 지역 화폐 단위 표시                                          |                          |        |                             |
| .                                                            |                               |                                           | 소수점 표시                                                  |                          |        |                             |
| ,                                                            |                               |                                           | 1000 단위 구분자 표시                                        |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 5. 일반 함수                                                 |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 사용방법                                                     |                               |                                           |                                                              |                          |        | 결과                        |
| SELECT  sal+NVL(comm, 0) FROM emp;                           |                               |                                           | (comm이 NULL이면 0을 리턴)                                   |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  NVL2(comm, 100, 0) FROM emp;                         |                               |                                           | (comm이 NULL이 아니면 100, NULL이면 0을 리턴)                |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  NULLIF(comm, 0) FROM emp;                            |                               |                                           | (comm이 0이면 NULL을 리턴)                                   |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  COALESCE(sal, comm, 0) FROM emp;                     |                               |                                           | (NULL이 아닌 첫번째 인자를 리턴)                             |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 9i부터 새롭게 등장한  CASE 함수                              |                               |                                           |                                                              |                          |        |                             |
| SELECT  empno, ename, sal, job,                              |                               |                                           |                                                              |                          |        |                             |
| CASE job WHEN 'ANALYST' THEN sal*1.1                         |                               |                                           |                                                              |                          |        |                             |
| WHEN 'CLERK' THEN sal*1.2                                    |                               |                                           |                                                              |                          |        |                             |
| WHEN 'MANAGER' THEN sal*1.3                                  |                               |                                           |                                                              |                          |        |                             |
| WHEN 'PRESIDENT' THEN sal*1.4                                |                               |                                           |                                                              |                          |        |                             |
| WHEN 'SALESMAN' THEN sal*1.5                                 |                               |                                           |                                                              |                          |        |                             |
| ELSE sal                                                     |                               |                                           |                                                              |                          |        |                             |
| END salary                                                   |                               |                                           |                                                              |                          |        |                             |
| FROM emp;                                                    |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 이전부터 사용했던  DECODE 함수                               |                               |                                           |                                                              |                          |        |                             |
| : 함수 내부에서  정렬작업이 수행되어, CASE 함수보다 속도가 느리다고 알려져 있음 |                               |                                           |                                                              |                          |        |                             |
| SELECT  empno, ename, sal, job,                              |                               |                                           |                                                              |                          |        |                             |
| DECODE(job, 'ANALYST', sal*1.1, 'CLERK',  sal*1.2, 'MANAGER', sal*1.3, 'PRESIDENT', sal*1.4, 'SALESMAN', sal*1.5, sal) |                               |                                           |                                                              |                          |        |                             |
| FROM emp;                                                    |                               |                                           |                                                              |                          |        |                             |
|                                                              |                               |                                           |                                                              |                          |        |                             |
| 부등호 조건인 경우,  DECODE를 사용하려면 매우 복잡하다. 대신 CASE를 사용하자. |                               |                                           |                                                              |                          |        |                             |
| SELECT  empno, ename, sal, job,                              |                               |                                           |                                                              |                          |        |                             |
| CASE WHEN sal < 500 THEN sal*1.1                             |                               |                                           |                                                              |                          |        |                             |
| WHEN sal < 800 THEN  sal*1.2                                 |                               |                                           |                                                              |                          |        |                             |
| WHEN sal < 1000 THEN  sal*1.3                                |                               |                                           |                                                              |                          |        |                             |
| WHEN sal < 1200 THEN  sal*1.4                                |                               |                                           |                                                              |                          |        |                             |
| WHEN sal < 1400 THEN  sal*1.5                                |                               |                                           |                                                              |                          |        |                             |
| ELSE sal                                                     |                               |                                           |                                                              |                          |        |                             |
| END salary                                                   |                               |                                           |                                                              |                          |        |                             |
| FROM emp;                                                    |                               |                                           |                                                              |                          |        |                             |